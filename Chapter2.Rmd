# 統計と確率の基本  
本章では、まず具体的な内容に入る前に、統計と確率の基本的な知識について確認します。なかでも、GLMやGLMMにおいて中心的な役割を持つ**確率分布**の知識は、今後非常に重要になってきます。  

## 統計学の基本  
### 統計学の二つの分類  
統計学はその目的に応じて、大きく分けて**記述統計**と**推測統計**に分けられます。  

#### 記述統計  
データが大量にあるとき、1つ1つの数値を見るだけではそのデータ全体の特徴は見えてきません。そこで、手持ちのデータを整理・要約するために用いられる統計学が**記述統計**です。具体的には、得られたデータの代表値(平均値・中央値)を算出したり、データの可視化を行うことで、データの特徴を容易に把握できるようにしていきます。  

#### 推測統計  
一方で、まだ手に入れていないデータを推測するための方法が**推測統計**です。  
実際の研究では、関心のある対象全体についてデータを取ることは不可能なことがほとんどです。例えば、「40代の日本人の」と思っても、日本に生息する全個体について調査することは不可能で、調査できるのはせいぜい一調査地の


# 確率分布の基礎  
## 確率分布とは  

## 連続変数  
### 正規分布  
$$
P(x) = \frac{1}{\sqrt{2 \pi \sigma^2}}exp(-\frac{(x-\mu)^2}{2\sigma^2})
$$

```{r}
mu <- 0
sigma <- c(1,sqrt(5),sqrt(10), sqrt(30))

crossing(x = seq(-17,17,by = 0.01),
         mu = mu,
         sigma = sigma) %>% 
  mutate(y = dnorm(x, mean = mu, sd = sigma)) %>% 
  ggplot(aes(x = x, y = y, color = as.factor(sigma)))+
  geom_line()+
  theme_bw(base_size = 13)+
  labs(y = "P(x)")+
  theme(legend.position = "none",
        axis.title.y = element_text(angle=0,
                                    vjust=0.5,
                                    face = "italic"))+
  scale_x_continuous(breaks = seq(-18,18,by = 3))

```

### ガンマ分布  

$$
P(x) = \frac{\beta^\alpha}{\Gamma(\alpha)} x^{\alpha-1} exp(-\beta x)  
$$

## 離散変数  


## ベルヌーイ分布  


### 二項分布  

- 平均: $\mu$  
- 分散: $\sigma^2$  

$$
P(x|n,p) = _n C _y p^x(1-p)^{n-x} \quad (x \geq 0)
$$
平均と分散は以下のようになる。  

- 平均: $np$  
- 分散: $np(1-p)$  

```{r, echo = FALSE}
p <- c(0.2,0.4,0.6,0.8)  
n <- 10

crossing(x = seq(0,10,by=1),
         p = p,
         n = n) %>% 
  mutate(y = dbinom(x, size = n, prob = p)) %>% 
  mutate(p = paste0(expression("p = "), p)) %>% 
  ggplot(aes(x=x,y=y))+
  geom_col()+
  theme_bw(base_size = 13)+
  labs(y = "P(x|n,p)")+
  theme(axis.title.y = element_text(angle=0,
                                    vjust=0.5,
                                    face = "italic"),
        axis.title.x = element_text(face = "italic"),
        strip.background = element_blank(),
        strip.text = element_text(hjust = 0))+
  scale_x_continuous(breaks = seq(0,10,2))+
  facet_rep_wrap(~p,
                 repeat.tick.labels = TRUE)
```


### ポワソン分布  

$$
P(x) = \frac{\lambda^x}{x!}e^{-\lambda} \quad (x \geq 0)
$$


```{r, echo = FALSE}
## 平均・分散のパラメータ
lambda <- c(1, 3, 5, 7)

annotate <- data.frame(lambda = lambda,
                       x = c(3,4,5.5,9),
                       y = c(0.35, 0.25, 0.2, 0.15)) %>%
  mutate(label = paste("lambda"," == ",lambda))

## lambda
crossing(lambda = lambda,
         x = seq(from = 0,to = 15,by = 1)) %>% 
  mutate(p = dpois(x,lambda)) %>% 
  ggplot(aes(x = x, y = p))+
  geom_line(aes(color = as.factor(lambda)))+
  labs(y = paste0("P(", expression(x),")"),
       x = expression(x))+
  theme_bw()+
  scale_color_nejm()+
  theme(axis.title.y = element_text(angle=0,
                                    vjust=0.5,
                                    face = "italic"),
        axis.title.x = element_text(face = "italic"),
        legend.position = "none")+
  geom_text(data = annotate,
            aes(x = x, y = y, label = label,
                color = as.factor(lambda)),
            parse = TRUE)
```

